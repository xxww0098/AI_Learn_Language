# 05 - æ¡ä»¶æ¸²æŸ“ä¸åˆ—è¡¨æ¸²æŸ“

## æ¡ä»¶æ¸²æŸ“

### åŸºæœ¬æ¡ä»¶æ¸²æŸ“
```jsx
function ConditionalRendering() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);
  const [userRole, setUserRole] = useState('guest');
  const [loading, setLoading] = useState(false);
  
  // 1. ä½¿ç”¨ && è¿ç®—ç¬¦
  const renderWelcome = () => (
    <div>
      {isLoggedIn && <h2>æ¬¢è¿å›æ¥ï¼</h2>}
      {!isLoggedIn && <h2>è¯·å…ˆç™»å½•</h2>}
    </div>
  );
  
  // 2. ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦
  const renderUserStatus = () => (
    <div>
      <p>çŠ¶æ€ï¼š{isLoggedIn ? 'å·²ç™»å½•' : 'æœªç™»å½•'}</p>
      <button onClick={() => setIsLoggedIn(!isLoggedIn)}>
        {isLoggedIn ? 'ç™»å‡º' : 'ç™»å½•'}
      </button>
    </div>
  );
  
  // 3. ä½¿ç”¨ if-else è¯­å¥
  const renderContent = () => {
    if (loading) {
      return <div>åŠ è½½ä¸­...</div>;
    }
    
    if (!isLoggedIn) {
      return (
        <div>
          <h3>è¯·ç™»å½•ä»¥æŸ¥çœ‹å†…å®¹</h3>
          <button onClick={() => setIsLoggedIn(true)}>ç™»å½•</button>
        </div>
      );
    }
    
    return (
      <div>
        <h3>æ¬¢è¿è®¿é—®æˆ‘ä»¬çš„åº”ç”¨ï¼</h3>
        <p>æ‚¨ç°åœ¨å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å†…å®¹äº†ã€‚</p>
      </div>
    );
  };
  
  // 4. å¤šæ¡ä»¶æ¸²æŸ“
  const renderUserRole = () => {
    switch (userRole) {
      case 'admin':
        return <div style={{color: 'red'}}>ç®¡ç†å‘˜é¢æ¿</div>;
      case 'user':
        return <div style={{color: 'blue'}}>ç”¨æˆ·é¢æ¿</div>;
      case 'guest':
        return <div style={{color: 'gray'}}>è®¿å®¢æ¨¡å¼</div>;
      default:
        return <div>æœªçŸ¥è§’è‰²</div>;
    }
  };
  
  return (
    <div style={{ padding: '20px' }}>
      <h2>æ¡ä»¶æ¸²æŸ“ç¤ºä¾‹</h2>
      
      {renderWelcome()}
      {renderUserStatus()}
      {renderContent()}
      
      <div style={{ marginTop: '20px' }}>
        <h3>ç”¨æˆ·è§’è‰²</h3>
        <select 
          value={userRole} 
          onChange={(e) => setUserRole(e.target.value)}
        >
          <option value="guest">è®¿å®¢</option>
          <option value="user">ç”¨æˆ·</option>
          <option value="admin">ç®¡ç†å‘˜</option>
        </select>
        {renderUserRole()}
      </div>
      
      <div style={{ marginTop: '20px' }}>
        <button onClick={() => setLoading(!loading)}>
          åˆ‡æ¢åŠ è½½çŠ¶æ€
        </button>
      </div>
    </div>
  );
}
```

## åˆ—è¡¨æ¸²æŸ“

### åŸºæœ¬åˆ—è¡¨æ¸²æŸ“
```jsx
function ListRendering() {
  const [students, setStudents] = useState([
    { id: 1, name: 'å¼ ä¸‰', age: 20, grade: 85 },
    { id: 2, name: 'æå››', age: 22, grade: 92 },
    { id: 3, name: 'ç‹äº”', age: 21, grade: 78 },
    { id: 4, name: 'èµµå…­', age: 23, grade: 89 }
  ]);
  
  const [filter, setFilter] = useState('all');
  const [sortBy, setSortBy] = useState('name');
  
  // è¿‡æ»¤å­¦ç”Ÿ
  const filteredStudents = students.filter(student => {
    switch (filter) {
      case 'excellent':
        return student.grade >= 90;
      case 'good':
        return student.grade >= 80 && student.grade < 90;
      case 'average':
        return student.grade < 80;
      default:
        return true;
    }
  });
  
  // æ’åºå­¦ç”Ÿ
  const sortedStudents = [...filteredStudents].sort((a, b) => {
    switch (sortBy) {
      case 'name':
        return a.name.localeCompare(b.name);
      case 'age':
        return a.age - b.age;
      case 'grade':
        return b.grade - a.grade; // é™åº
      default:
        return 0;
    }
  });
  
  return (
    <div style={{ padding: '20px' }}>
      <h2>å­¦ç”Ÿåˆ—è¡¨</h2>
      
      {/* è¿‡æ»¤å™¨ */}
      <div style={{ marginBottom: '20px' }}>
        <label>ç­›é€‰ï¼š</label>
        <select value={filter} onChange={(e) => setFilter(e.target.value)}>
          <option value="all">å…¨éƒ¨</option>
          <option value="excellent">ä¼˜ç§€ (â‰¥90åˆ†)</option>
          <option value="good">è‰¯å¥½ (80-89åˆ†)</option>
          <option value="average">ä¸€èˆ¬ (&lt;80åˆ†)</option>
        </select>
        
        <label style={{ marginLeft: '20px' }}>æ’åºï¼š</label>
        <select value={sortBy} onChange={(e) => setSortBy(e.target.value)}>
          <option value="name">å§“å</option>
          <option value="age">å¹´é¾„</option>
          <option value="grade">æˆç»©</option>
        </select>
      </div>
      
      {/* å­¦ç”Ÿåˆ—è¡¨ */}
      <div>
        {sortedStudents.length === 0 ? (
          <p>æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­¦ç”Ÿ</p>
        ) : (
          <table style={{ width: '100%', borderCollapse: 'collapse' }}>
            <thead>
              <tr style={{ backgroundColor: '#f5f5f5' }}>
                <th style={{ border: '1px solid #ddd', padding: '8px' }}>å§“å</th>
                <th style={{ border: '1px solid #ddd', padding: '8px' }}>å¹´é¾„</th>
                <th style={{ border: '1px solid #ddd', padding: '8px' }}>æˆç»©</th>
                <th style={{ border: '1px solid #ddd', padding: '8px' }}>ç­‰çº§</th>
              </tr>
            </thead>
            <tbody>
              {sortedStudents.map(student => (
                <tr key={student.id}>
                  <td style={{ border: '1px solid #ddd', padding: '8px' }}>
                    {student.name}
                  </td>
                  <td style={{ border: '1px solid #ddd', padding: '8px' }}>
                    {student.age}
                  </td>
                  <td style={{ border: '1px solid #ddd', padding: '8px' }}>
                    {student.grade}
                  </td>
                  <td style={{ border: '1px solid #ddd', padding: '8px' }}>
                    {student.grade >= 90 ? 'ä¼˜ç§€' : 
                     student.grade >= 80 ? 'è‰¯å¥½' : 'ä¸€èˆ¬'}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
      
      <p>æ€»å…± {students.length} åå­¦ç”Ÿï¼Œæ˜¾ç¤º {sortedStudents.length} å</p>
    </div>
  );
}
```

## å®è·µæ¡ˆä¾‹ï¼šåŠ¨æ€èœå•ç³»ç»Ÿ

```jsx
function DynamicMenuSystem() {
  const [menuItems, setMenuItems] = useState([
    {
      id: 1,
      title: 'é¦–é¡µ',
      path: '/',
      icon: 'ğŸ ',
      visible: true,
      children: []
    },
    {
      id: 2,
      title: 'äº§å“',
      path: '/products',
      icon: 'ğŸ“¦',
      visible: true,
      children: [
        { id: 21, title: 'ç”µå­äº§å“', path: '/products/electronics', visible: true },
        { id: 22, title: 'æœè£…', path: '/products/clothing', visible: false },
        { id: 23, title: 'ä¹¦ç±', path: '/products/books', visible: true }
      ]
    },
    {
      id: 3,
      title: 'å…³äºæˆ‘ä»¬',
      path: '/about',
      icon: 'â„¹ï¸',
      visible: true,
      children: []
    },
    {
      id: 4,
      title: 'è”ç³»æˆ‘ä»¬',
      path: '/contact',
      icon: 'ğŸ“',
      visible: false,
      children: []
    }
  ]);
  
  const [expandedItems, setExpandedItems] = useState(new Set());
  const [userRole, setUserRole] = useState('user'); // user, admin
  
  // åˆ‡æ¢å±•å¼€çŠ¶æ€
  const toggleExpanded = (itemId) => {
    const newExpanded = new Set(expandedItems);
    if (newExpanded.has(itemId)) {
      newExpanded.delete(itemId);
    } else {
      newExpanded.add(itemId);
    }
    setExpandedItems(newExpanded);
  };
  
  // åˆ‡æ¢èœå•é¡¹å¯è§æ€§
  const toggleVisibility = (itemId, parentId = null) => {
    setMenuItems(prevItems => 
      prevItems.map(item => {
        if (item.id === itemId && !parentId) {
          return { ...item, visible: !item.visible };
        }
        if (item.id === parentId) {
          return {
            ...item,
            children: item.children.map(child =>
              child.id === itemId ? { ...child, visible: !child.visible } : child
            )
          };
        }
        return item;
      })
    );
  };
  
  // æ¸²æŸ“èœå•é¡¹
  const renderMenuItem = (item, level = 0) => {
    const hasChildren = item.children && item.children.length > 0;
    const isExpanded = expandedItems.has(item.id);
    const visibleChildren = item.children?.filter(child => child.visible) || [];
    
    return (
      <div key={item.id} style={{ marginLeft: `${level * 20}px` }}>
        <div
          style={{
            padding: '10px',
            borderBottom: '1px solid #eee',
            display: 'flex',
            alignItems: 'center',
            backgroundColor: level === 0 ? '#f8f9fa' : 'white'
          }}
        >
          <span style={{ marginRight: '10px' }}>{item.icon}</span>
          <span 
            style={{ 
              flex: 1, 
              cursor: hasChildren ? 'pointer' : 'default',
              fontWeight: level === 0 ? 'bold' : 'normal'
            }}
            onClick={() => hasChildren && toggleExpanded(item.id)}
          >
            {item.title}
          </span>
          
          {hasChildren && (
            <span style={{ marginRight: '10px' }}>
              {isExpanded ? 'â–¼' : 'â–¶'}
            </span>
          )}
          
          {userRole === 'admin' && (
            <button
              onClick={() => toggleVisibility(item.id)}
              style={{
                backgroundColor: item.visible ? '#28a745' : '#dc3545',
                color: 'white',
                border: 'none',
                padding: '2px 8px',
                borderRadius: '3px',
                fontSize: '12px'
              }}
            >
              {item.visible ? 'æ˜¾ç¤º' : 'éšè—'}
            </button>
          )}
        </div>
        
        {/* æ¸²æŸ“å­èœå• */}
        {hasChildren && isExpanded && (
          <div>
            {visibleChildren.map(child => renderMenuItem(child, level + 1))}
          </div>
        )}
      </div>
    );
  };
  
  // è¿‡æ»¤å¯è§çš„ä¸»èœå•é¡¹
  const visibleMenuItems = menuItems.filter(item => item.visible);
  
  return (
    <div style={{ padding: '20px' }}>
      <div style={{ marginBottom: '20px' }}>
        <h2>åŠ¨æ€èœå•ç³»ç»Ÿ</h2>
        <label>
          ç”¨æˆ·è§’è‰²ï¼š
          <select 
            value={userRole} 
            onChange={(e) => setUserRole(e.target.value)}
          >
            <option value="user">æ™®é€šç”¨æˆ·</option>
            <option value="admin">ç®¡ç†å‘˜</option>
          </select>
        </label>
      </div>
      
      <div style={{ border: '1px solid #ddd', borderRadius: '5px' }}>
        {visibleMenuItems.length === 0 ? (
          <div style={{ padding: '20px', textAlign: 'center' }}>
            æ²¡æœ‰å¯æ˜¾ç¤ºçš„èœå•é¡¹
          </div>
        ) : (
          visibleMenuItems.map(item => renderMenuItem(item))
        )}
      </div>
      
      {userRole === 'admin' && (
        <div style={{ marginTop: '20px', padding: '10px', backgroundColor: '#fff3cd' }}>
          <strong>ç®¡ç†å‘˜æç¤ºï¼š</strong>ç‚¹å‡»æŒ‰é’®å¯ä»¥åˆ‡æ¢èœå•é¡¹çš„æ˜¾ç¤º/éšè—çŠ¶æ€
        </div>
      )}
    </div>
  );
}
```

## é«˜çº§åˆ—è¡¨æ¨¡å¼

### å¸¦åˆ†é¡µçš„åˆ—è¡¨
```jsx
function PaginatedList() {
  const [allItems] = useState(
    Array.from({ length: 100 }, (_, i) => ({
      id: i + 1,
      name: `é¡¹ç›® ${i + 1}`,
      category: ['ç”µå­', 'æœè£…', 'ä¹¦ç±', 'å®¶å…·'][i % 4],
      price: Math.floor(Math.random() * 1000) + 10,
      featured: Math.random() > 0.7
    }))
  );
  
  const [currentPage, setCurrentPage] = useState(1);
  const [itemsPerPage, setItemsPerPage] = useState(10);
  const [categoryFilter, setCategoryFilter] = useState('all');
  const [showFeaturedOnly, setShowFeaturedOnly] = useState(false);
  
  // è¿‡æ»¤æ•°æ®
  const filteredItems = allItems.filter(item => {
    const matchesCategory = categoryFilter === 'all' || item.category === categoryFilter;
    const matchesFeatured = !showFeaturedOnly || item.featured;
    return matchesCategory && matchesFeatured;
  });
  
  // åˆ†é¡µè®¡ç®—
  const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
  const startIndex = (currentPage - 1) * itemsPerPage;
  const endIndex = startIndex + itemsPerPage;
  const currentItems = filteredItems.slice(startIndex, endIndex);
  
  // é¡µç æ•°ç»„
  const getPageNumbers = () => {
    const pages = [];
    const maxVisiblePages = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
    
    if (endPage - startPage + 1 < maxVisiblePages) {
      startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }
    
    for (let i = startPage; i <= endPage; i++) {
      pages.push(i);
    }
    return pages;
  };
  
  return (
    <div style={{ padding: '20px' }}>
      <h2>åˆ†é¡µåˆ—è¡¨ç¤ºä¾‹</h2>
      
      {/* è¿‡æ»¤å™¨ */}
      <div style={{ marginBottom: '20px', display: 'flex', gap: '20px', alignItems: 'center' }}>
        <div>
          <label>åˆ†ç±»ï¼š</label>
          <select 
            value={categoryFilter} 
            onChange={(e) => {
              setCategoryFilter(e.target.value);
              setCurrentPage(1);
            }}
          >
            <option value="all">å…¨éƒ¨</option>
            <option value="ç”µå­">ç”µå­</option>
            <option value="æœè£…">æœè£…</option>
            <option value="ä¹¦ç±">ä¹¦ç±</option>
            <option value="å®¶å…·">å®¶å…·</option>
          </select>
        </div>
        
        <div>
          <label>æ¯é¡µæ˜¾ç¤ºï¼š</label>
          <select 
            value={itemsPerPage} 
            onChange={(e) => {
              setItemsPerPage(Number(e.target.value));
              setCurrentPage(1);
            }}
          >
            <option value={5}>5</option>
            <option value={10}>10</option>
            <option value={20}>20</option>
          </select>
        </div>
        
        <label>
          <input
            type="checkbox"
            checked={showFeaturedOnly}
            onChange={(e) => {
              setShowFeaturedOnly(e.target.checked);
              setCurrentPage(1);
            }}
          />
          åªæ˜¾ç¤ºæ¨èå•†å“
        </label>
      </div>
      
      {/* å•†å“åˆ—è¡¨ */}
      <div style={{ marginBottom: '20px' }}>
        {currentItems.length === 0 ? (
          <p>æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å•†å“</p>
        ) : (
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '15px' }}>
            {currentItems.map(item => (
              <div key={item.id} style={{
                border: '1px solid #ddd',
                padding: '15px',
                borderRadius: '5px',
                backgroundColor: item.featured ? '#fff3cd' : 'white'
              }}>
                <h4>{item.name}</h4>
                <p>åˆ†ç±»ï¼š{item.category}</p>
                <p>ä»·æ ¼ï¼šÂ¥{item.price}</p>
                {item.featured && <span style={{color: '#856404'}}>â­ æ¨è</span>}
              </div>
            ))}
          </div>
        )}
      </div>
      
      {/* åˆ†é¡µæ§ä»¶ */}
      {totalPages > 1 && (
        <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '5px' }}>
          <button 
            onClick={() => setCurrentPage(1)}
            disabled={currentPage === 1}
          >
            é¦–é¡µ
          </button>
          <button 
            onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}
            disabled={currentPage === 1}
          >
            ä¸Šä¸€é¡µ
          </button>
          
          {getPageNumbers().map(pageNum => (
            <button
              key={pageNum}
              onClick={() => setCurrentPage(pageNum)}
              style={{
                backgroundColor: currentPage === pageNum ? '#007bff' : '#f8f9fa',
                color: currentPage === pageNum ? 'white' : 'black',
                border: '1px solid #ddd',
                padding: '5px 10px'
              }}
            >
              {pageNum}
            </button>
          ))}
          
          <button 
            onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}
            disabled={currentPage === totalPages}
          >
            ä¸‹ä¸€é¡µ
          </button>
          <button 
            onClick={() => setCurrentPage(totalPages)}
            disabled={currentPage === totalPages}
          >
            æœ«é¡µ
          </button>
        </div>
      )}
      
      <div style={{ textAlign: 'center', marginTop: '10px' }}>
        <small>
          æ˜¾ç¤ºç¬¬ {startIndex + 1}-{Math.min(endIndex, filteredItems.length)} é¡¹ï¼Œ
          å…± {filteredItems.length} é¡¹ (ç¬¬ {currentPage}/{totalPages} é¡µ)
        </small>
      </div>
    </div>
  );
}
```

## ç»ƒä¹ ä»»åŠ¡

1. åˆ›å»ºä¸€ä¸ªæ–°é—»åˆ—è¡¨ï¼Œæ”¯æŒæŒ‰ç±»åˆ«ç­›é€‰å’Œæ—¶é—´æ’åº
2. å®ç°ä¸€ä¸ªå›¾ç‰‡ç”»å»Šï¼Œæ”¯æŒåˆ†ç±»æµè§ˆå’Œæœç´¢
3. åˆ¶ä½œä¸€ä¸ªå‘˜å·¥ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰

## ä¸‹ä¸€æ­¥

æŒæ¡æ¡ä»¶æ¸²æŸ“å’Œåˆ—è¡¨æ¸²æŸ“åï¼Œä¸‹ä¸€ç« å°†å­¦ä¹ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„åŸºç¡€çŸ¥è¯†ã€‚